
[tasks.uninstall-hooks]
description = "Uninstall git hooks"
run = ["lefthook uninstall"]

[tasks.encrypt-secrets]
description = "Encrypt secrets file with SOPS"
run = ["sops --encrypt --input-type json --output-type json .env.secrets.json.example > .env.secrets.json"]

[tasks.decrypt-secrets]
description = "Decrypt secrets file with SOPS"
run = ["sops --decrypt .env.secrets.json"]

[tasks.edit-secrets]
description = "Edit encrypted secrets file"
run = ["sops .env.secrets.json"]

[tasks.generate-age-key]
description = "Generate new age key pair for secrets encryption"
run = ["./scripts/setup/generate-age-key.sh"]

[tasks.inject-secret]
description = "Inject or update a secret in .env.secrets.json (creates file if needed)"
run = ["./scripts/setup/inject-secret.sh \"$@\""]

[tasks.inject-gh-secret]
description = "Inject secrets from .env.secrets.json into GitHub Actions"
run = ["./scripts/setup/inject-gh-secret.sh \"$@\""]

[tasks.validate-workflows]
description = "Validate GitHub Actions workflows"
run = [
  "if [ -d .github/workflows ]; then",
  "  action-validator .github/workflows/*.yml .github/workflows/*.yaml 2>/dev/null || true",
  "else",
  "  echo 'No workflows found in .github/workflows'",
  "fi"
]